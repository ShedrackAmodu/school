{% extends 'base/base.html' %}
{% load static i18n %}

{% block title %}{% trans "Delete Holiday" %} - {{ holiday.name }}{% endblock %}

{% block body_class %}academics-holiday-delete{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item"><a href="{% url 'academics:holiday_list' %}">{% trans "Holidays" %}</a></li>
<li class="breadcrumb-item"><a href="{% url 'academics:holiday_detail' holiday.pk %}">{{ holiday.name }}</a></li>
<li class="breadcrumb-item active" aria-current="page">{% trans "Delete" %}</li>
{% endblock %}

{% block page_actions %}
<div class="page-actions">
    <div class="btn-group" role="group">
        <a href="{% url 'academics:holiday_detail' holiday.pk %}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left me-2"></i>{% trans "Back to Holiday" %}
        </a>
        <a href="{% url 'academics:holiday_list' %}" class="btn btn-outline-info">
            <i class="bi bi-list me-2"></i>{% trans "All Holidays" %}
        </a>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/academics/forms.css' %}">
<style>
.delete-header {
    background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
    color: white;
    padding: 2rem;
    border-radius: 0.75rem;
    margin-bottom: 2rem;
    box-shadow: 0 4px 20px rgba(220, 53, 69, 0.2);
}

.delete-header h1 {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
}

.delete-header p {
    opacity: 0.9;
    margin-bottom: 0;
}

.delete-card {
    border: none;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    overflow: hidden;
}

.delete-card .card-header {
    background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
    border-bottom: 1px solid #f5c6cb;
    padding: 1.5rem;
}

.delete-card .card-body {
    padding: 2rem;
}

.warning-icon {
    font-size: 4rem;
    color: #dc3545;
    margin-bottom: 1rem;
}

.holiday-info {
    background-color: #f8f9fa;
    border-radius: 8px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border-left: 4px solid #dc3545;
}

.holiday-info h5 {
    color: #495057;
    margin-bottom: 1rem;
}

.info-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid #e9ecef;
}

.info-item:last-child {
    border-bottom: none;
}

.info-label {
    font-weight: 600;
    color: #495057;
}

.info-value {
    color: #6c757d;
}

.impact-alert {
    background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
    border: none;
    border-radius: 8px;
    border-left: 4px solid #ffc107;
    padding: 1.5rem;
    margin-bottom: 2rem;
}

.impact-alert .alert-icon {
    color: #856404;
    font-size: 1.5rem;
    margin-right: 0.5rem;
}

.btn-delete {
    background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
    border: none;
    border-radius: 8px;
    padding: 0.75rem 2rem;
    font-weight: 600;
    font-size: 1rem;
    color: white;
    transition: all 0.3s ease;
}

.btn-delete:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
}

.btn-cancel {
    border-radius: 8px;
    padding: 0.75rem 2rem;
    font-weight: 600;
    font-size: 1rem;
    border: 2px solid #6c757d;
    background: transparent;
    color: #6c757d;
    transition: all 0.3s ease;
}

.btn-cancel:hover {
    background-color: #6c757d;
    color: white;
    transform: translateY(-2px);
}
</style>
{% endblock %}

{% block content %}
<div class="holiday-delete-container">
    <!-- Delete Header -->
    <div class="delete-header text-center">
        <div class="row align-items-center">
            <div class="col-md-8 mx-auto">
                <div class="warning-icon">
                    <i class="bi bi-exclamation-triangle-fill"></i>
                </div>
                <h1 class="mb-1">
                    <i class="bi bi-trash me-3"></i>{% trans "Delete Holiday" %}
                </h1>
                <p class="mb-0">
                    {% trans "Are you sure you want to delete this holiday? This action cannot be undone." %}
                </p>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Card -->
    <div class="card delete-card">
        <div class="card-header">
            <h5 class="card-title mb-0 text-danger">
                <i class="bi bi-exclamation-triangle me-2"></i>
                {% trans "Confirm Deletion" %}
            </h5>
        </div>
        <div class="card-body">
            <!-- Holiday Information -->
            <div class="holiday-info">
                <h5>
                    <i class="bi bi-calendar-event me-2 text-primary"></i>
                    {% trans "Holiday Details" %}
                </h5>
                <div class="info-item">
                    <span class="info-label">{% trans "Name:" %}</span>
                    <span class="info-value">{{ holiday.name }}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">{% trans "Date:" %}</span>
                    <span class="info-value">{{ holiday.date|date:"l, F j, Y" }}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">{% trans "Type:" %}</span>
                    <span class="info-value">
                        {% if holiday.is_recurring %}
                            <span class="badge bg-info">
                                <i class="bi bi-arrow-repeat me-1"></i>{% trans "Recurring" %}
                            </span>
                        {% else %}
                            <span class="badge bg-success">
                                <i class="bi bi-calendar-event me-1"></i>{% trans "One-time" %}
                            </span>
                        {% endif %}
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">{% trans "Academic Session:" %}</span>
                    <span class="info-value">{{ holiday.academic_session.name }}</span>
                </div>
                {% if holiday.description %}
                <div class="info-item">
                    <span class="info-label">{% trans "Description:" %}</span>
                    <span class="info-value">{{ holiday.description|truncatewords:10 }}</span>
                </div>
                {% endif %}
            </div>

            <!-- Impact Warning -->
            <div class="impact-alert">
                <div class="d-flex align-items-start">
                    <div class="alert-icon">
                        <i class="bi bi-exclamation-triangle-fill"></i>
                    </div>
                    <div>
                        <strong>{% trans "Important Warning:" %}</strong>
                        <p class="mb-2 mt-1">
                            {% trans "Deleting this holiday will permanently remove it from the academic calendar. This action:" %}
                        </p>
                        <ul class="mb-0">
                            <li>{% trans "Cannot be undone" %}</li>
                            <li>{% trans "May affect academic scheduling and planning" %}</li>
                            {% if holiday.is_recurring %}
                            <li>{% trans "Will remove this recurring holiday from all future sessions" %}</li>
                            {% endif %}
                            <li>{% trans "May impact attendance calculations and reports" %}</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Confirmation Form -->
            <form method="post">
                {% csrf_token %}

                <div class="text-center">
                    <p class="mb-4 text-muted">
                        {% trans "Please confirm that you want to delete the holiday" %}
                        <strong>"{{ holiday.name }}"</strong>.
                    </p>

                    <div class="d-flex justify-content-center gap-3">
                        <a href="{% url 'academics:holiday_detail' holiday.pk %}" class="btn btn-cancel">
                            <i class="bi bi-x-circle me-2"></i>{% trans "Cancel" %}
                        </a>
                        <button type="submit" class="btn btn-delete">
                            <i class="bi bi-trash me-2"></i>{% trans "Yes, Delete Holiday" %}
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add confirmation dialog for delete button
        const deleteBtn = document.querySelector('.btn-delete');

        if (deleteBtn) {
            deleteBtn.addEventListener('click', function(e) {
                const holidayName = '{{ holiday.name|escapejs }}';
                const confirmMessage = `{% trans "Are you sure you want to permanently delete the holiday" %} "${holidayName}"? {% trans "This action cannot be undone." %}`;

                if (!confirm(confirmMessage)) {
                    e.preventDefault();
                    return false;
                }

                // Add loading state
                deleteBtn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>{% trans "Deleting..." %}';
                deleteBtn.disabled = true;
            });
        }

        console.log('Holiday delete confirmation page loaded.');
    });
</script>
{% endblock %}
