{% extends "base/base.html" %}

{% block title %}Notification Settings{% endblock %}

{% block content %}
<div class="settings-container" style="max-width: 1000px; margin: 0 auto; padding: 20px;">
    <!-- Header Section -->
    <div class="settings-header" style="margin-bottom: 32px;">
        <div style="text-align: center;">
            <h1 style="font-size: 32px; font-weight: 700; color: #1f2937; margin: 0 0 8px 0;">Notification Settings</h1>
            <p style="color: #6b7280; margin: 0; font-size: 16px;">Customize how and when you receive notifications</p>
        </div>
    </div>

    <!-- Settings Navigation -->
    <div class="settings-nav" style="margin-bottom: 32px;">
        <div class="nav-tabs" style="display: flex; border-bottom: 1px solid #e5e7eb; overflow-x: auto;">
            <button class="nav-tab active" data-tab="general" style="padding: 12px 20px; border: none; background: none; font-weight: 500; color: #3b82f6; border-bottom: 2px solid #3b82f6; white-space: nowrap; cursor: pointer;">
                General Settings
            </button>
            <button class="nav-tab" data-tab="channels" style="padding: 12px 20px; border: none; background: none; font-weight: 500; color: #6b7280; white-space: nowrap; cursor: pointer;">
                Delivery Channels
            </button>
            <button class="nav-tab" data-tab="categories" style="padding: 12px 20px; border: none; background: none; font-weight: 500; color: #6b7280; white-space: nowrap; cursor: pointer;">
                Notification Categories
            </button>
            <button class="nav-tab" data-tab="scheduling" style="padding: 12px 20px; border: none; background: none; font-weight: 500; color: #6b7280; white-space: nowrap; cursor: pointer;">
                Quiet Hours
            </button>
        </div>
    </div>

    <!-- Settings Content -->
    <div class="settings-content">
        <!-- General Settings Tab -->
        <div id="general-tab" class="tab-content active">
            <div class="settings-card" style="background: white; border-radius: 12px; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); padding: 24px; margin-bottom: 24px;">
                <h2 style="font-size: 20px; font-weight: 600; margin: 0 0 20px 0; color: #1f2937;">Global Notification Preferences</h2>
                
                <div class="setting-item" style="display: flex; justify-content: between; align-items: center; padding: 16px 0; border-bottom: 1px solid #f3f4f6;">
                    <div>
                        <h3 style="font-size: 16px; font-weight: 500; margin: 0 0 4px 0; color: #1f2937;">Enable All Notifications</h3>
                        <p style="margin: 0; color: #6b7280; font-size: 14px;">Master switch for all notification types</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="enableAll" checked style="display: none;">
                        <span class="slider" style="position: relative; display: inline-block; width: 52px; height: 28px; background: #3b82f6; border-radius: 34px; transition: .4s; cursor: pointer;">
                            <span class="slider-circle" style="position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                        </span>
                    </label>
                </div>

                <div class="setting-item" style="display: flex; justify-content: between; align-items: center; padding: 16px 0; border-bottom: 1px solid #f3f4f6;">
                    <div>
                        <h3 style="font-size: 16px; font-weight: 500; margin: 0 0 4px 0; color: #1f2937;">Desktop Notifications</h3>
                        <p style="margin: 0; color: #6b7280; font-size: 14px;">Show browser notifications when available</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="desktopNotifications" checked style="display: none;">
                        <span class="slider" style="position: relative; display: inline-block; width: 52px; height: 28px; background: #3b82f6; border-radius: 34px; transition: .4s; cursor: pointer;">
                            <span class="slider-circle" style="position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                        </span>
                    </label>
                </div>

                <div class="setting-item" style="display: flex; justify-content: between; align-items: center; padding: 16px 0;">
                    <div>
                        <h3 style="font-size: 16px; font-weight: 500; margin: 0 0 4px 0; color: #1f2937;">Sound Alerts</h3>
                        <p style="margin: 0; color: #6b7280; font-size: 14px;">Play sound for important notifications</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="soundAlerts" style="display: none;">
                        <span class="slider" style="position: relative; display: inline-block; width: 52px; height: 28px; background: #d1d5db; border-radius: 34px; transition: .4s; cursor: pointer;">
                            <span class="slider-circle" style="position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                        </span>
                    </label>
                </div>
            </div>

            <div class="settings-card" style="background: white; border-radius: 12px; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); padding: 24px;">
                <h2 style="font-size: 20px; font-weight: 600; margin: 0 0 20px 0; color: #1f2937;">Notification Display</h2>
                
                <div class="setting-item" style="margin-bottom: 20px;">
                    <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px; color: #374151;">Default View</label>
                    <select id="defaultView" style="width: 100%; max-width: 300px; padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white;">
                        <option value="all">All Notifications</option>
                        <option value="unread">Unread Only</option>
                        <option value="important">Important Only</option>
                    </select>
                </div>

                <div class="setting-item" style="margin-bottom: 20px;">
                    <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px; color: #374151;">Items Per Page</label>
                    <select id="itemsPerPage" style="width: 100%; max-width: 300px; padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white;">
                        <option value="10">10 items</option>
                        <option value="20" selected>20 items</option>
                        <option value="50">50 items</option>
                        <option value="100">100 items</option>
                    </select>
                </div>

                <div class="setting-item">
                    <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px; color: #374151;">Auto-mark as Read</label>
                    <select id="autoMarkRead" style="width: 100%; max-width: 300px; padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white;">
                        <option value="never">Never</option>
                        <option value="7days">After 7 days</option>
                        <option value="30days">After 30 days</option>
                        <option value="viewed">When viewed in list</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Delivery Channels Tab -->
        <div id="channels-tab" class="tab-content" style="display: none;">
            <div class="settings-card" style="background: white; border-radius: 12px; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); padding: 24px; margin-bottom: 24px;">
                <h2 style="font-size: 20px; font-weight: 600; margin: 0 0 20px 0; color: #1f2937;">Delivery Methods</h2>
                
                <div class="channel-item" style="display: flex; justify-content: between; align-items: flex-start; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 16px;">
                    <div style="display: flex; align-items: flex-start; gap: 16px; flex-grow: 1;">
                        <div class="channel-icon" style="width: 48px; height: 48px; background: #dbeafe; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px;">
                            ðŸ“§
                        </div>
                        <div>
                            <h3 style="font-size: 16px; font-weight: 600; margin: 0 0 4px 0; color: #1f2937;">Email Notifications</h3>
                            <p style="margin: 0; color: #6b7280; font-size: 14px; line-height: 1.4;">
                                Receive notifications via email. Currently set to: <strong>user@example.com</strong>
                            </p>
                            <div class="channel-settings" style="display: flex; gap: 16px; margin-top: 12px;">
                                <label style="display: flex; align-items: center; gap: 6px; font-size: 14px;">
                                    <input type="checkbox" checked> Important notifications
                                </label>
                                <label style="display: flex; align-items: center; gap: 6px; font-size: 14px;">
                                    <input type="checkbox"> Daily digest
                                </label>
                                <label style="display: flex; align-items: center; gap: 6px; font-size: 14px;">
                                    <input type="checkbox" checked> Weekly summary
                                </label>
                            </div>
                        </div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" checked style="display: none;">
                        <span class="slider" style="position: relative; display: inline-block; width: 52px; height: 28px; background: #3b82f6; border-radius: 34px; transition: .4s; cursor: pointer;">
                            <span class="slider-circle" style="position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                        </span>
                    </label>
                </div>

                <div class="channel-item" style="display: flex; justify-content: between; align-items: flex-start; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 16px;">
                    <div style="display: flex; align-items: flex-start; gap: 16px; flex-grow: 1;">
                        <div class="channel-icon" style="width: 48px; height: 48px; background: #d1fae5; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px;">
                            ðŸ“±
                        </div>
                        <div>
                            <h3 style="font-size: 16px; font-weight: 600; margin: 0 0 4px 0; color: #1f2937;">Push Notifications</h3>
                            <p style="margin: 0; color: #6b7280; font-size: 14px; line-height: 1.4;">
                                Receive push notifications on your devices
                            </p>
                            <div style="margin-top: 12px;">
                                <button id="testPushBtn" style="background: #3b82f6; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 14px; cursor: pointer;">
                                    Test Push Notification
                                </button>
                            </div>
                        </div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" checked style="display: none;">
                        <span class="slider" style="position: relative; display: inline-block; width: 52px; height: 28px; background: #3b82f6; border-radius: 34px; transition: .4s; cursor: pointer;">
                            <span class="slider-circle" style="position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                        </span>
                    </label>
                </div>

                <div class="channel-item" style="display: flex; justify-content: between; align-items: flex-start; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px;">
                    <div style="display: flex; align-items: flex-start; gap: 16px; flex-grow: 1;">
                        <div class="channel-icon" style="width: 48px; height: 48px; background: #fef3c7; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px;">
                            ðŸ’¬
                        </div>
                        <div>
                            <h3 style="font-size: 16px; font-weight: 600; margin: 0 0 4px 0; color: #1f2937;">SMS Notifications</h3>
                            <p style="margin: 0; color: #6b7280; font-size: 14px; line-height: 1.4;">
                                Receive important alerts via SMS. Current number: <strong>+1 (555) 123-4567</strong>
                            </p>
                            <div style="margin-top: 12px;">
                                <button style="background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; padding: 8px 16px; border-radius: 6px; font-size: 14px; cursor: pointer;">
                                    Update Phone Number
                                </button>
                            </div>
                        </div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" style="display: none;">
                        <span class="slider" style="position: relative; display: inline-block; width: 52px; height: 28px; background: #d1d5db; border-radius: 34px; transition: .4s; cursor: pointer;">
                            <span class="slider-circle" style="position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                        </span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Notification Categories Tab -->
        <div id="categories-tab" class="tab-content" style="display: none;">
            <div class="settings-card" style="background: white; border-radius: 12px; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); padding: 24px;">
                <h2 style="font-size: 20px; font-weight: 600; margin: 0 0 20px 0; color: #1f2937;">Notification Categories</h2>
                <p style="color: #6b7280; margin: 0 0 24px 0;">Customize which types of notifications you want to receive</p>
                
                <div class="category-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px;">
                    <!-- Academic Notifications -->
                    <div class="category-card" style="border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px;">
                        <div style="display: flex; justify-content: between; align-items: flex-start; margin-bottom: 16px;">
                            <h3 style="font-size: 16px; font-weight: 600; margin: 0; color: #1f2937;">Academic Updates</h3>
                            <label class="toggle-switch">
                                <input type="checkbox" checked style="display: none;">
                                <span class="slider" style="position: relative; display: inline-block; width: 44px; height: 24px; background: #3b82f6; border-radius: 34px; transition: .4s; cursor: pointer;">
                                    <span class="slider-circle" style="position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                                </span>
                            </label>
                        </div>
                        <div class="category-options" style="space-y: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox" checked> Class schedules
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox" checked> Assignment deadlines
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox"> Grade updates
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox" checked> CBT notifications
                            </label>
                        </div>
                    </div>

                    <!-- System Notifications -->
                    <div class="category-card" style="border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px;">
                        <div style="display: flex; justify-content: between; align-items: flex-start; margin-bottom: 16px;">
                            <h3 style="font-size: 16px; font-weight: 600; margin: 0; color: #1f2937;">System Alerts</h3>
                            <label class="toggle-switch">
                                <input type="checkbox" checked style="display: none;">
                                <span class="slider" style="position: relative; display: inline-block; width: 44px; height: 24px; background: #3b82f6; border-radius: 34px; transition: .4s; cursor: pointer;">
                                    <span class="slider-circle" style="position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                                </span>
                            </label>
                        </div>
                        <div class="category-options" style="space-y: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox" checked> Security alerts
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox"> System maintenance
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox" checked> Feature updates
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox"> Policy changes
                            </label>
                        </div>
                    </div>

                    <!-- Communication Notifications -->
                    <div class="category-card" style="border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px;">
                        <div style="display: flex; justify-content: between; align-items: flex-start; margin-bottom: 16px;">
                            <h3 style="font-size: 16px; font-weight: 600; margin: 0; color: #1f2937;">Communication</h3>
                            <label class="toggle-switch">
                                <input type="checkbox" checked style="display: none;">
                                <span class="slider" style="position: relative; display: inline-block; width: 44px; height: 24px; background: #3b82f6; border-radius: 34px; transition: .4s; cursor: pointer;">
                                    <span class="slider-circle" style="position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                                </span>
                            </label>
                        </div>
                        <div class="category-options" style="space-y: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox" checked> New messages
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox"> Announcements
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox" checked> Meeting reminders
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox"> Event invitations
                            </label>
                        </div>
                    </div>

                    <!-- Financial Notifications -->
                    <div class="category-card" style="border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px;">
                        <div style="display: flex; justify-content: between; align-items: flex-start; margin-bottom: 16px;">
                            <h3 style="font-size: 16px; font-weight: 600; margin: 0; color: #1f2937;">Financial Updates</h3>
                            <label class="toggle-switch">
                                <input type="checkbox" style="display: none;">
                                <span class="slider" style="position: relative; display: inline-block; width: 44px; height: 24px; background: #d1d5db; border-radius: 34px; transition: .4s; cursor: pointer;">
                                    <span class="slider-circle" style="position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                                </span>
                            </label>
                        </div>
                        <div class="category-options" style="space-y: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox"> Fee reminders
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox"> Payment confirmations
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox"> Scholarship updates
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                                <input type="checkbox"> Financial aid
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quiet Hours Tab -->
        <div id="scheduling-tab" class="tab-content" style="display: none;">
            <div class="settings-card" style="background: white; border-radius: 12px; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); padding: 24px;">
                <h2 style="font-size: 20px; font-weight: 600; margin: 0 0 20px 0; color: #1f2937;">Quiet Hours</h2>
                <p style="color: #6b7280; margin: 0 0 24px 0;">Set times when you don't want to receive notifications</p>
                
                <div class="quiet-hours-setting" style="display: flex; align-items: center; gap: 16px; margin-bottom: 24px; padding: 20px; background: #f8fafc; border-radius: 8px;">
                    <label class="toggle-switch">
                        <input type="checkbox" id="enableQuietHours" style="display: none;">
                        <span class="slider" style="position: relative; display: inline-block; width: 52px; height: 28px; background: #d1d5db; border-radius: 34px; transition: .4s; cursor: pointer;">
                            <span class="slider-circle" style="position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                        </span>
                    </label>
                    <div>
                        <h3 style="font-size: 16px; font-weight: 600; margin: 0 0 4px 0; color: #1f2937;">Enable Quiet Hours</h3>
                        <p style="margin: 0; color: #6b7280; font-size: 14px;">Pause notifications during specified times</p>
                    </div>
                </div>

                <div id="quietHoursSettings" style="display: none;">
                    <div class="time-settings" style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 16px; align-items: end; margin-bottom: 24px;">
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px; color: #374151;">Start Time</label>
                            <input type="time" value="22:00" style="width: 100%; padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                        </div>
                        <div style="text-align: center; padding-bottom: 10px; color: #6b7280;">to</div>
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px; color: #374151;">End Time</label>
                            <input type="time" value="07:00" style="width: 100%; padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                        </div>
                    </div>

                    <div class="days-settings" style="margin-bottom: 24px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 12px; color: #374151;">Apply to days</label>
                        <div class="days-grid" style="display: flex; gap: 8px;">
                            <label style="flex: 1; text-align: center; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px; cursor: pointer;">
                                <input type="checkbox" style="display: none;">
                                <span>Weekdays</span>
                            </label>
                            <label style="flex: 1; text-align: center; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px; cursor: pointer;">
                                <input type="checkbox" style="display: none;">
                                <span>Weekends</span>
                            </label>
                            <label style="flex: 1; text-align: center; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px; cursor: pointer;">
                                <input type="checkbox" style="display: none;" checked>
                                <span>Everyday</span>
                            </label>
                        </div>
                    </div>

                    <div class="emergency-override" style="padding: 16px; background: #fef3c7; border-radius: 6px;">
                        <label style="display: flex; align-items: center; gap: 8px; font-size: 14px;">
                            <input type="checkbox" checked>
                            <strong>Allow urgent notifications during quiet hours</strong>
                        </label>
                        <p style="margin: 8px 0 0 0; color: #92400e; font-size: 13px;">
                            Critical alerts and emergency messages will still be delivered
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons" style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 32px; padding-top: 24px; border-top: 1px solid #e5e7eb;">
        <button id="resetBtn" style="background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; padding: 12px 24px; border-radius: 6px; font-weight: 500; cursor: pointer;">
            Reset to Defaults
        </button>
        <button id="saveBtn" style="background: #3b82f6; color: white; border: none; padding: 12px 32px; border-radius: 6px; font-weight: 500; cursor: pointer;">
            Save Changes
        </button>
    </div>
</div>

<style>
    /* Toggle switch active state */
    .toggle-switch input:checked + .slider {
        background: #3b82f6 !important;
    }
    
    .toggle-switch input:checked + .slider .slider-circle {
        transform: translateX(24px) !important;
    }
    
    .toggle-switch input:checked + .slider.small .slider-circle {
        transform: translateX(20px) !important;
    }
    
    /* Tab active state */
    .nav-tab.active {
        color: #3b82f6 !important;
        border-bottom-color: #3b82f6 !important;
    }
    
    /* Hover effects */
    .nav-tab:hover {
        color: #3b82f6 !important;
    }
    
    .toggle-switch:hover .slider {
        opacity: 0.8;
    }
    
    .category-card:hover {
        border-color: #3b82f6 !important;
    }
    
    .channel-item:hover {
        border-color: #3b82f6 !important;
    }
    
    /* Button hover effects */
    #saveBtn:hover {
        background: #2563eb !important;
    }
    
    #resetBtn:hover {
        background: #e5e7eb !important;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .settings-nav {
            overflow-x: auto;
        }
        
        .nav-tabs {
            min-width: max-content;
        }
        
        .category-grid {
            grid-template-columns: 1fr !important;
        }
        
        .time-settings {
            grid-template-columns: 1fr !important;
            gap: 12px !important;
        }
        
        .days-grid {
            flex-direction: column;
        }
    }
    
    @media (max-width: 640px) {
        .setting-item {
            flex-direction: column;
            align-items: flex-start !important;
            gap: 12px;
        }
        
        .channel-item {
            flex-direction: column;
            gap: 16px;
        }
        
        .action-buttons {
            flex-direction: column;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Tab navigation
        const tabs = document.querySelectorAll('.nav-tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const targetTab = this.getAttribute('data-tab');
                
                // Update active tab
                tabs.forEach(t => {
                    t.classList.remove('active');
                    t.style.color = '#6b7280';
                    t.style.borderBottom = 'none';
                });
                this.classList.add('active');
                this.style.color = '#3b82f6';
                this.style.borderBottom = '2px solid #3b82f6';
                
                // Show target content
                tabContents.forEach(content => {
                    content.classList.remove('active');
                    content.style.display = 'none';
                });
                document.getElementById(`${targetTab}-tab`).classList.add('active');
                document.getElementById(`${targetTab}-tab`).style.display = 'block';
            });
        });
        
        // Toggle switch functionality
        document.querySelectorAll('.toggle-switch input').forEach(checkbox => {
            const slider = checkbox.nextElementSibling;
            
            // Set initial state
            if (checkbox.checked) {
                slider.style.background = '#3b82f6';
                slider.querySelector('.slider-circle').style.transform = 'translateX(24px)';
            }
            
            // Add click handler
            slider.addEventListener('click', function() {
                checkbox.checked = !checkbox.checked;
                
                if (checkbox.checked) {
                    this.style.background = '#3b82f6';
                    this.querySelector('.slider-circle').style.transform = 'translateX(24px)';
                } else {
                    this.style.background = '#d1d5db';
                    this.querySelector('.slider-circle').style.transform = 'translateX(4px)';
                }
                
                // Special handling for quiet hours
                if (checkbox.id === 'enableQuietHours') {
                    const quietHoursSettings = document.getElementById('quietHoursSettings');
                    if (checkbox.checked) {
                        quietHoursSettings.style.display = 'block';
                    } else {
                        quietHoursSettings.style.display = 'none';
                    }
                }
                
                // Special handling for enable all
                if (checkbox.id === 'enableAll') {
                    const allToggles = document.querySelectorAll('.toggle-switch input');
                    allToggles.forEach(toggle => {
                        if (toggle !== checkbox) {
                            toggle.checked = checkbox.checked;
                            const toggleSlider = toggle.nextElementSibling;
                            if (checkbox.checked) {
                                toggleSlider.style.background = '#3b82f6';
                                toggleSlider.querySelector('.slider-circle').style.transform = 'translateX(24px)';
                            } else {
                                toggleSlider.style.background = '#d1d5db';
                                toggleSlider.querySelector('.slider-circle').style.transform = 'translateX(4px)';
                            }
                        }
                    });
                }
            });
        });
        
        // Test push notification
        const testPushBtn = document.getElementById('testPushBtn');
        if (testPushBtn) {
            testPushBtn.addEventListener('click', function() {
                if ('Notification' in window && Notification.permission === 'granted') {
                    new Notification('Test Notification', {
                        body: 'This is a test push notification from your settings',
                        icon: '/static/images/logo.png'
                    });
                    showToast('Test notification sent!', 'success');
                } else {
                    showToast('Please enable notifications in your browser settings', 'warning');
                }
            });
        }
        
        // Save settings
        const saveBtn = document.getElementById('saveBtn');
        if (saveBtn) {
            saveBtn.addEventListener('click', function() {
                // Show loading state
                saveBtn.innerHTML = 'Saving...';
                saveBtn.disabled = true;
                
                // Simulate API call
                setTimeout(() => {
                    showToast('Settings saved successfully!', 'success');
                    saveBtn.innerHTML = 'Save Changes';
                    saveBtn.disabled = false;
                }, 1000);
            });
        }
        
        // Reset settings
        const resetBtn = document.getElementById('resetBtn');
        if (resetBtn) {
            resetBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to reset all settings to default?')) {
                    // Reset all toggles
                    document.querySelectorAll('.toggle-switch input').forEach(checkbox => {
                        checkbox.checked = false;
                        const slider = checkbox.nextElementSibling;
                        slider.style.background = '#d1d5db';
                        slider.querySelector('.slider-circle').style.transform = 'translateX(4px)';
                    });
                    
                    // Reset select elements
                    document.getElementById('defaultView').value = 'all';
                    document.getElementById('itemsPerPage').value = '20';
                    document.getElementById('autoMarkRead').value = 'never';
                    
                    showToast('Settings reset to defaults', 'info');
                }
            });
        }
        
        // Day selection for quiet hours
        document.querySelectorAll('.days-grid label').forEach(label => {
            const checkbox = label.querySelector('input');
            
            label.addEventListener('click', function() {
                checkbox.checked = !checkbox.checked;
                
                if (checkbox.checked) {
                    this.style.background = '#3b82f6';
                    this.style.color = 'white';
                    this.style.borderColor = '#3b82f6';
                } else {
                    this.style.background = 'white';
                    this.style.color = '#374151';
                    this.style.borderColor = '#d1d5db';
                }
            });
            
            // Set initial state
            if (checkbox.checked) {
                label.style.background = '#3b82f6';
                label.style.color = 'white';
                label.style.borderColor = '#3b82f6';
            }
        });
        
        // Toast notification function
        function showToast(message, type = 'info') {
            // Remove existing toasts
            const existingToasts = document.querySelectorAll('.toast-notification');
            existingToasts.forEach(toast => toast.remove());
            
            // Create toast element
            const toast = document.createElement('div');
            toast.className = `toast-notification toast-${type}`;
            toast.innerHTML = message;
            
            // Style the toast
            Object.assign(toast.style, {
                position: 'fixed',
                top: '20px',
                right: '20px',
                padding: '12px 20px',
                borderRadius: '6px',
                color: 'white',
                fontWeight: '500',
                zIndex: '1000',
                boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
                transition: 'all 0.3s ease',
                transform: 'translateX(100%)',
                opacity: '0'
            });
            
            // Set background color based on type
            const bgColors = {
                'success': '#10b981',
                'error': '#ef4444',
                'info': '#3b82f6',
                'warning': '#f59e0b'
            };
            toast.style.backgroundColor = bgColors[type] || bgColors.info;
            
            // Add to page
            document.body.appendChild(toast);
            
            // Animate in
            setTimeout(() => {
                toast.style.transform = 'translateX(0)';
                toast.style.opacity = '1';
            }, 10);
            
            // Remove after 3 seconds
            setTimeout(() => {
                toast.style.transform = 'translateX(100%)';
                toast.style.opacity = '0';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }
    });
</script>
{% endblock %}