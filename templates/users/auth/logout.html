{% extends 'base/base.html' %}
{% load static i18n %}

{% block title %}{% trans "Logout Successful - Excellence Academy" %}{% endblock %}

{% block meta_description %}{% trans "You have been successfully logged out of the Excellence Academy." %}{% endblock %}

{% block body_class %}logout-page{% endblock %}

{% block header %}{% endblock %}
{% block navigation %}{% endblock %}
{% block sidebar %}{% endblock %}
{% block page_header %}{% endblock %}

{% block content %}
<div class="logout-container min-vh-100 d-flex align-items-center justify-content-center bg-light">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6 col-md-8">
                <!-- Logout Card -->
                <div class="card logout-card border-0 shadow-lg text-center">
                    <div class="card-body p-5">
                        <!-- Success Icon -->
                        <div class="logout-icon mb-4">
                            <div class="icon-wrapper bg-success text-white rounded-circle mx-auto">
                                <i class="bi bi-check-lg"></i>
                            </div>
                        </div>

                        <!-- Success Message -->
                        <h2 class="fw-bold text-success mb-3">{% trans "Logout Successful" %}</h2>
                        <p class="text-muted mb-4 lead">
                            {% trans "You have been successfully logged out of the Excellence Academy." %}
                        </p>

                        <!-- Security Notice -->
                        <div class="alert alert-info border-0 mb-4">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-shield-check me-3 fs-4"></i>
                                <div class="text-start">
                                    <h6 class="alert-heading mb-1">{% trans "Security Notice" %}</h6>
                                    <p class="mb-0 small">{% trans "For security reasons, please close your browser window, especially if you are using a shared or public computer." %}</p>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="row g-3">
                            <div class="col-md-6">
                                <a href="{% url 'users:login' %}" class="btn btn-primary btn-lg w-100">
                                    <i class="bi bi-box-arrow-in-right me-2"></i>
                                    {% trans "Sign In Again" %}
                                </a>
                            </div>
                            <div class="col-md-6">
                                <a href="{% url 'users:guest_home' %}" class="btn btn-outline-secondary btn-lg w-100">
                                    <i class="bi bi-house me-2"></i>
                                    {% trans "Return Home" %}
                                </a>
                            </div>
                        </div>

                        <!-- Quick Links -->
                        <div class="mt-5 pt-4 border-top">
                            <h6 class="text-muted mb-3">{% trans "Quick Access" %}</h6>
                            <div class="row g-2">
                                <div class="col-4">
                                    <a href="{% url 'users:password_reset' %}" class="btn btn-outline-primary btn-sm w-100">
                                        {% trans "Reset Password" %}
                                    </a>
                                </div>
                                <div class="col-4">
                                    <a href="{% url 'support:contact' %}" class="btn btn-outline-info btn-sm w-100">
                                        {% trans "Get Help" %}
                                    </a>
                                </div>
                                <div class="col-4">
                                    <a href="{% url 'users:application_portal' %}" class="btn btn-outline-success btn-sm w-100">
                                        {% trans "Apply Now" %}
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- System Status -->
                    <div class="card-footer bg-light border-0 py-3">
                        <div class="row align-items-center">
                            <div class="col-md-6 text-md-start">
                                <small class="text-muted">
                                    <i class="bi bi-clock me-1"></i>
                                    {% trans "Session ended at" %} {% now "H:i" %}
                                </small>
                            </div>
                            <div class="col-md-6 text-md-end">
                                <small class="text-muted">
                                    <i class="bi bi-shield-lock me-1"></i>
                                    {% trans "Secure logout completed" %}
                                </small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Auto-redirect Notice -->
                <div class="text-center mt-4">
                    <p class="text-muted small">
                        <i class="bi bi-info-circle me-1"></i>
                        {% trans "You will be automatically redirected to the home page in" %}
                        <span id="countdown">10</span> {% trans "seconds" %}
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.logout-page {
    background: linear-gradient(135deg, #198754 0%, #146c43 100%);
    position: relative;
    overflow: hidden;
}

.logout-page::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url("{% static 'images/logout-bg-pattern.svg' %}") no-repeat center center;
    background-size: cover;
    opacity: 0.1;
    z-index: 0;
}

.logout-container {
    position: relative;
    z-index: 1;
}

.logout-card {
    border-radius: 1rem;
    backdrop-filter: blur(10px);
    background: rgba(255, 255, 255, 0.95);
}

.icon-wrapper {
    width: 80px;
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
}

/* Animations */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes bounceIn {
    0% {
        opacity: 0;
        transform: scale(0.3);
    }
    50% {
        opacity: 1;
        transform: scale(1.05);
    }
    70% {
        transform: scale(0.9);
    }
    100% {
        opacity: 1;
        transform: scale(1);
    }
}

.logout-card {
    animation: fadeInUp 0.6s ease-out;
}

.icon-wrapper {
    animation: bounceIn 0.6s ease-out;
}

/* Button Styles */
.btn {
    border-radius: 0.5rem;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn:hover {
    transform: translateY(-1px);
}

/* Dark Theme Support */
[data-bs-theme="dark"] .logout-page {
    background: linear-gradient(135deg, #212529 0%, #343a40 100%);
}

[data-bs-theme="dark"] .logout-card {
    background: rgba(33, 37, 41, 0.95);
    color: #fff;
}

[data-bs-theme="dark"] .text-muted {
    color: #adb5bd !important;
}

/* Responsive Design */
@media (max-width: 575.98px) {
    .logout-card .card-body {
        padding: 2rem 1.5rem;
    }
    
    .icon-wrapper {
        width: 60px;
        height: 60px;
        font-size: 2rem;
    }
}

/* Countdown Animation */
#countdown {
    font-weight: bold;
    color: #0d6efd;
}

/* Accessibility */
@media (prefers-reduced-motion: reduce) {
    .logout-card,
    .icon-wrapper,
    .btn {
        animation: none;
        transition: none;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Auto-redirect countdown
    let countdown = 10;
    const countdownElement = document.getElementById('countdown');
    const countdownInterval = setInterval(() => {
        countdown--;
        countdownElement.textContent = countdown;
        
        if (countdown <= 0) {
            clearInterval(countdownInterval);
            window.location.href = "{% url 'users:guest_home' %}";
        }
    }, 1000);
    
    // Allow user to cancel auto-redirect by interacting with the page
    let userInteracted = false;
    
    document.addEventListener('click', function() {
        userInteracted = true;
        clearInterval(countdownInterval);
        countdownElement.textContent = '0';
        countdownElement.parentElement.innerHTML = 
            '<i class="bi bi-pause-circle me-1"></i>{% trans "Auto-redirect cancelled" %}';
    });
    
    document.addEventListener('keydown', function() {
        userInteracted = true;
        clearInterval(countdownInterval);
        countdownElement.textContent = '0';
        countdownElement.parentElement.innerHTML = 
            '<i class="bi bi-pause-circle me-1"></i>{% trans "Auto-redirect cancelled" %}';
    });
    
    // Clear any remaining session data (client-side)
    function clearClientSession() {
        // Clear any sensitive data from localStorage
        const sensitiveKeys = [
            'user_session_data',
            'auth_token',
            'temp_credentials'
        ];
        
        sensitiveKeys.forEach(key => {
            localStorage.removeItem(key);
        });
        
        // Clear sessionStorage
        sessionStorage.clear();
    }
    
    clearClientSession();
});
</script>
{% endblock %}